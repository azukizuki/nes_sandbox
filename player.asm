;Player制御ロジック
;$0010 ~ $00FFまでを使う

PLAYER_INITIALIZE:
	;Y座標
	LDA #$50
	STA $0010
	;X座標
	LDA #$50
	STA $0011

	;サウンド再生してからの時間カウンタ
	LDA #$00
	STA $1012

	; HAS INPUT
	LDA #$00
	STA $1013

	;サウンド再生中フラグ
	LDA #$00
	STA $1014

	RTS

PLAYER_UPDATE:
	RTS

PLAYER_ON_NMI:

	;入力があったかのフラグを折っておく
	LDA #$00
	STA $1013

;入力判定
;位置の更新と、入力フラグを立てる
	LDA $0024
	BEQ PLAYER_RELEASE_UP
	DEC $0010
	INC $1013
PLAYER_RELEASE_UP:
	LDA $0025
	BEQ PLAYER_RELEASE_DOWN
	INC $0010
	INC $1013
PLAYER_RELEASE_DOWN:
	LDA $0026
	BEQ PLAYER_RELEASE_LEFT
	DEC $0011
	INC $1013
PLAYER_RELEASE_LEFT:
	LDA $0027
	BEQ PLAYER_RELEASE_RIGHT
	INC $0011
	INC $1013
PLAYER_RELEASE_RIGHT:

	;入力フラグを見て、入力されてたらSE再生
	LDA $1013
	BEQ PLAYER_NOT_INPUT
	JSR PLAYER_PLAY_SE
	JMP PLAYER_DRAW
	;入力されてないときは再生管理フラグを折る（連続で再生されないように制御してる）
PLAYER_NOT_INPUT:
	LDA #$00
	STA $1014

PLAYER_DRAW:

	LDA $0010
	LDX $0011
	LDY 0
	JSR DRAW_SPRITE
	RTS


PLAYER_PLAY_SE:
	;再生中だったらrtsへ
	LDA $1014
	BNE PLAYER_PLAY_SE_RET
	JSR SOUND_PLAY_SHORT
	;再生中フラグを立てる
	INC $1014
PLAYER_PLAY_SE_RET:
	RTS